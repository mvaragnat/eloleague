<!-- Overview panel -->
<div data-tabs-target="panel">
  <%= render 'tournament_overview', tournament: tournament %>
</div>

<!-- Rounds panel with inner round tabs -->
<div data-tabs-target="panel" style="display:none;">
  <div data-controller="tabs"
       data-tabs-active-index-value="<%= @active_round_index %>"
       data-tabs-param-name-value="round_tab">
    <div style="display:flex; gap:0.5rem; margin-bottom:0.75rem; flex-wrap:wrap;">
      <% rounds.each_with_index do |round, idx| %>
        <a href="#"
           data-action="click->tabs#select"
           data-index="<%= idx %>"
           data-tabs-target="tab"
           class="btn <%= idx == 0 ? 'btn-primary' : '' %>"
           aria-selected="<%= idx == 0 ? 'true' : 'false' %>">
          <%= t('tournaments.show.round_label', n: round.number) %>
        </a>
      <% end %>
    </div>

    <% rounds.each_with_index do |round, idx| %>
      <div data-tabs-target="panel" style="<%= idx == 0 ? '' : 'display:none;' %>">
        <div class="card">
          <div class="card-body">
            <% if round.matches.any? %>
              <% ms = round.matches.to_a %>
              <% if ms.any? { |m| m.table_number.present? } %>
                <% ms = ms.sort_by { |m| [m.table_number ? 0 : 1, m.table_number || 0] } %>
              <% end %>
              <%= render 'matches_grid', tournament: tournament, matches: ms %>
            <% else %>
              <p class="card-date"><%= t('tournaments.show.no_matches', default: 'No matches yet') %></p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<!-- Participants panel -->
<div data-tabs-target="panel" style="display:none;">
  <%= render 'participants', registrations: registrations, tournament: tournament %>
</div>

<!-- Ranking panel -->
<div data-tabs-target="panel" style="display:none;">
  <%= render 'ranking_table', standings: standings, tournament: tournament %>
</div>

<% if tournament.creator == Current.user %>
  <!-- Admin panel -->
  <div data-tabs-target="panel" style="display:none;">
    <div class="card">
      <div class="card-body" style="display:flex; flex-direction:column; gap:1rem;">
        <%= render 'admin_actions', tournament: tournament, can_move_to_next_round: can_move_to_next_round, move_block_reason: move_block_reason %>
      </div>
    </div>
  </div>
<% end %>


